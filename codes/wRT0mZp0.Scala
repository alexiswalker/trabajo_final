{"version":"NotebookV1","origId":1396019039180600,"name":"40 - Dataframes and SQL","language":"scala","commands":[{"version":"CommandV1","origId":1396019039180601,"guid":"8903ee9f-8ffd-4e30-9898-2de7a051ce49","subtype":"command","commandType":"auto","position":1.0,"command":"%md # DataFrames and Spark SQL\n\nDataset Reference: [https://www.ics.uci.edu/~duboisc/stackoverflow/](https://www.ics.uci.edu/~duboisc/stackoverflow/  target=\"_blank\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781209,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e043346e-0a48-4728-9e4c-5788d6696cc8"},{"version":"CommandV1","origId":1396019039180602,"guid":"c6b6a9ed-2290-4f14-a93b-9821c6513eaf","subtype":"command","commandType":"auto","position":1.5,"command":"%md ## Motivation for DataFrames\n\n * Much easier to use\n * It will be familiar if your used *R* or *Pandas*\n * The provide an SQL API\n * You can use the *same* API for many data sources, such as:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781238,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7714f538-f16b-4840-a975-f76c9e947dce"},{"version":"CommandV1","origId":1396019039180603,"guid":"8b71028b-f645-43ba-bfe3-782ceab61b5d","subtype":"command","commandType":"auto","position":1.75,"command":"%md ![DataFrame input sources](http://looper.hu/spark/dataframe-sources.png)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781252,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7f93ad7-da0e-477c-ba42-3ec1fc24ef75"},{"version":"CommandV1","origId":1396019039180604,"guid":"8afd5471-56dd-4777-a8bd-96f4fd496e65","subtype":"command","commandType":"auto","position":1.8125,"command":"%md Also, it's much more performant then RDDs:\n![DataFrame performance](http://looper.hu/spark/df-performance.png)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781267,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e9fad0c-7e7e-40c9-ab2f-57ee127197eb"},{"version":"CommandV1","origId":1396019039180605,"guid":"a7c39f4c-d475-4d38-9537-f8576e4c1847","subtype":"command","commandType":"auto","position":1.875,"command":"%md You can read into DataFrames from many sources. We will use the `parquet` format, because this is one of the most advanced file format around.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781289,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eb077c1d-ed5c-4798-9b9e-eceaaea5074d"},{"version":"CommandV1","origId":1396019039180606,"guid":"914d4ccb-df85-411a-97c7-fdfe735f5e52","subtype":"command","commandType":"auto","position":2.0,"command":"val posts = spark.read.parquet(\"/mnt/spark-data/posts.parquet\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322536100,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eee187e4-6a93-4286-9c6e-a7cfc3ea7edb"},{"version":"CommandV1","origId":1396019039180607,"guid":"075d2264-9001-4b49-b098-110183080cb7","subtype":"command","commandType":"auto","position":2.5,"command":"%md Let's cache it right away:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781329,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"92152176-cf79-4cae-b594-2b8cc3dfb9bf"},{"version":"CommandV1","origId":1396019039180608,"guid":"65f35e82-8826-4973-aade-803c8c4f3b2d","subtype":"command","commandType":"auto","position":2.75,"command":"posts.cache().count()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322582446,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a492d01-218c-4619-a03b-feac31835102"},{"version":"CommandV1","origId":1396019039180609,"guid":"6f4e1334-17e1-4ff2-8a9d-4d4e2ba98614","subtype":"command","commandType":"auto","position":3.0,"command":"posts.show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322602251,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f2c3beb7-7766-4a8a-8ab7-15590b9f770c"},{"version":"CommandV1","origId":1396019039180611,"guid":"5c44a7c4-5d9a-428d-860b-ab32a83cdd9f","subtype":"command","commandType":"auto","position":3.25,"command":"%md Show less rows","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781381,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1ab5cfbc-1d96-4680-80d0-f9e1ab53c28a"},{"version":"CommandV1","origId":1396019039180612,"guid":"f46b0396-f6f3-40bb-9c4f-3a6d03cd7468","subtype":"command","commandType":"auto","position":3.375,"command":"posts.show(3)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781395,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f5b57129-95ea-45a8-86b2-ffb095f4e062"},{"version":"CommandV1","origId":1396019039180613,"guid":"95ab7549-12a2-4b3a-995f-e7dfced16912","subtype":"command","commandType":"auto","position":3.5,"command":"%md DataFrames have a schema","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781403,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e68a581e-81ee-4d3e-83c5-ee60f7fcf69e"},{"version":"CommandV1","origId":1396019039180614,"guid":"9d038fc2-bb70-49bc-aa42-b35ebbdbb130","subtype":"command","commandType":"auto","position":4.0,"command":"posts.printSchema()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322622655,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"086266ee-097d-46cd-b8f4-4c8e43195244"},{"version":"CommandV1","origId":1396019039180615,"guid":"8d1c80c2-64c4-4892-9c90-6569cc1c82bb","subtype":"command","commandType":"auto","position":4.25,"command":"%md ...and there is an RDD behind:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781448,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a11243d-8478-4d76-bd3f-fc58d31e3bdd"},{"version":"CommandV1","origId":1396019039180616,"guid":"e91ed2bf-6f1c-4753-9a5c-4dbe02675117","subtype":"command","commandType":"auto","position":4.375,"command":"posts.rdd.take(1).foreach(println)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322782634,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e9b10a7-8afd-4fae-a83b-58ea754bdbb8"},{"version":"CommandV1","origId":1396019039180617,"guid":"b2493a3d-e198-40af-8b90-94f9e033b0de","subtype":"command","commandType":"auto","position":4.5,"command":"%md ## Common operations ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781476,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ac3d6c0c-5910-4347-927c-14f643520e2f"},{"version":"CommandV1","origId":1396019039180618,"guid":"b03db604-8049-4b6e-8f64-4fea4606aad4","subtype":"command","commandType":"auto","position":4.75,"command":"%md ### Selecting fields","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781490,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"adfd4075-8642-4859-b434-3acb70e8dc46"},{"version":"CommandV1","origId":1396019039180619,"guid":"b6a42e05-785b-4402-8d81-392013f9e913","subtype":"command","commandType":"auto","position":4.875,"command":"posts.select(\"site\", \"tags\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322845393,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"179eda4a-6306-4aba-a731-cebabe6df7a5"},{"version":"CommandV1","origId":1396019039180620,"guid":"b006e783-bd1f-4608-8474-90dd8b150b5b","subtype":"command","commandType":"auto","position":4.9375,"command":"posts.select($\"site\", $\"tags\").show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508322850754,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f867c520-a28d-4e5c-8b11-0b9c8248c802"},{"version":"CommandV1","origId":1396019039180623,"guid":"9d452aac-6ee7-426e-a268-7a4fed2445d2","subtype":"command","commandType":"auto","position":4.984375,"command":"val extraScore = posts.select($\"title\",$\"score\", $\"score\" / 100)\nextraScore.show(5)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781555,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bdfb9bbd-22b2-4ccd-8eea-ecfccd60b369"},{"version":"CommandV1","origId":1396019039180624,"guid":"6acbabd8-c123-4988-baf5-578a072e4396","subtype":"command","commandType":"auto","position":4.986328125,"command":"val extraScore = posts.select($\"title\",$\"score\", $\"score\" > 50)\nextraScore.show(5)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781563,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"184a259b-57ea-45e3-a04d-90e9f69858b2"},{"version":"CommandV1","origId":1396019039180625,"guid":"476a0fe7-8c0e-4af3-90d1-4ee762b04a06","subtype":"command","commandType":"auto","position":4.98828125,"command":"%md ### Filtering","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781572,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3402c2e2-0f51-4182-ae07-266a2d9926c9"},{"version":"CommandV1","origId":1396019039180626,"guid":"ce57a93f-b71f-4075-a949-b94af601bab4","subtype":"command","commandType":"auto","position":4.9921875,"command":"val highScores = posts.filter($\"score\" > 100)\nhighScores.select($\"title\", $\"score\").show(10, false)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323005377,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ca9bd75c-52d0-4b34-9096-a719d7bf3067"},{"version":"CommandV1","origId":1396019039180627,"guid":"e22f8a4c-249b-4fc9-bbc0-5b2ed9732f28","subtype":"command","commandType":"auto","position":4.99609375,"command":"highScores.filter($\"score\" > 100).filter($\"favoriteCount\" > 10).select($\"title\").show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508326934655,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f1872d4-cc3b-4fa0-8f53-68228058aea5"},{"version":"CommandV1","origId":1396019039180628,"guid":"285a8528-845b-43f8-ac8f-75e3c29992ef","subtype":"command","commandType":"auto","position":4.9970703125,"command":"posts.filter($\"site\" === \"datascience\").select($\"site\", $\"title\").show(3,false)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781601,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22fb3be5-95cd-4e2f-aeca-1cefca6f6c19"},{"version":"CommandV1","origId":1396019039180631,"guid":"a5f056ef-fb50-4018-88e2-72d6e759bb95","subtype":"command","commandType":"auto","position":4.99755859375,"command":"%md ** One more question: **\n\n * In scala you can reference the columns like this: `$\"column\"`, `col(\"column\")`, `df(\"column\")`\n * In R like this: `df$column`\n * In python like this: `df[\"column\"]`, `df.column`\n\n*Which one do you prefer*?","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781629,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3463d89c-4c6a-429f-bfa7-835b7b862e66"},{"version":"CommandV1","origId":1396019039180632,"guid":"526555f1-b1a2-4740-9f05-bb4c5ff72202","subtype":"command","commandType":"auto","position":4.998046875,"command":"%md ### Grouping","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781648,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a2b76b6-aceb-4b26-a220-3993c4574286"},{"version":"CommandV1","origId":1396019039180633,"guid":"0b58c44c-f5e2-4def-9397-ce51240b850d","subtype":"command","commandType":"auto","position":4.9990234375,"command":"val favCounts = posts.groupBy($\"site\").count()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323832584,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa43c722-e4e3-444a-8bc5-81d94541b8de"},{"version":"CommandV1","origId":1396019039180634,"guid":"2ea11165-747d-4f9a-9378-77e2908ebac5","subtype":"command","commandType":"auto","position":4.99951171875,"command":"%md Hey, `count()` should be an action!","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781670,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40abb815-e035-4b53-80b7-a09e0e742ace"},{"version":"CommandV1","origId":1396019039180635,"guid":"2d12faa9-a9d6-476c-95cf-c8508cc53ab8","subtype":"command","commandType":"auto","position":4.9996337890625,"command":"posts.groupBy($\"site\").count().show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323620868,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6eb16c54-256f-449d-a693-2aa6822e0f0d"},{"version":"CommandV1","origId":1396019039180636,"guid":"97346f2f-30b8-45f1-9c83-9dee32c7ba36","subtype":"command","commandType":"auto","position":4.999755859375,"command":"posts.count()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323818921,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ca300fe-2c9e-4919-8e21-87005b978e13"},{"version":"CommandV1","origId":1396019039180637,"guid":"24251bab-4a6a-4b07-b343-4493945c5a89","subtype":"command","commandType":"auto","position":4.9998779296875,"command":"%md ^^ action, looks good","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781702,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e0dc9627-a7f2-4e5d-b3ef-c4e0880e2e91"},{"version":"CommandV1","origId":1396019039180638,"guid":"15eb1a4e-cc95-487a-8797-4d841965dddb","subtype":"command","commandType":"auto","position":4.99993896484375,"command":"posts.groupBy($\"site\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323645409,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cfe2f2b1-5f2a-4f2d-a6d6-85dc1e03669c"},{"version":"CommandV1","origId":1396019039180639,"guid":"f36f6b14-fe83-404e-9eae-41322759c096","subtype":"command","commandType":"auto","position":4.999969482421875,"command":"%md ^^ `RelationalGroupedDataset`. this is not a dataframe! ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781723,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c864aedd-3604-4c5d-a3e6-cf462e833e9e"},{"version":"CommandV1","origId":1396019039180640,"guid":"6115598d-e1ca-4d6b-997b-df510854a545","subtype":"command","commandType":"auto","position":4.9999847412109375,"command":"posts.groupBy($\"site\").count","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781738,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc67dc3f-66b6-4034-844a-41b5a5e99ab8"},{"version":"CommandV1","origId":1396019039180641,"guid":"92c065a8-7da2-4ba6-8e57-0d2de5342fff","subtype":"command","commandType":"auto","position":4.999985694885254,"command":"%md ^^ This is a DataFrame","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781745,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"96441418-4dc5-41d0-ac0e-c8ce02560cbd"},{"version":"CommandV1","origId":1396019039180642,"guid":"f314624b-513b-4d89-829f-a030ab39b541","subtype":"command","commandType":"auto","position":4.999986171722412,"command":"posts.groupBy($\"site\").count().show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323792847,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4da21aa-565f-4809-bb4a-09fe6317f68d"},{"version":"CommandV1","origId":1396019039180643,"guid":"42504d48-9125-45a4-b38a-19f884075fb2","subtype":"command","commandType":"auto","position":4.99998664855957,"command":"%md There are many other functions you can apply to DataFrame columns, check them out in the [documentation](https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781766,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c39a5b3-4fa0-43cd-8e3e-3fec6df7ba74"},{"version":"CommandV1","origId":1396019039180644,"guid":"7798b7ea-feac-44af-8d5e-eeb7f943936b","subtype":"command","commandType":"auto","position":4.999987602233887,"command":"// import all the functions\nimport org.apache.spark.sql.functions._","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323882040,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c6091bb0-d384-4654-925b-3e645d01cef2"},{"version":"CommandV1","origId":1396019039180645,"guid":"16cf3f12-f054-45cc-9268-604e84c4082d","subtype":"command","commandType":"auto","position":4.9999876618385315,"command":"%md See how favorite counts correlate with views","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781786,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2f004683-059f-4d8e-8f4f-de0bec82bab2"},{"version":"CommandV1","origId":1396019039180646,"guid":"8733c825-6921-4ac7-99d2-597dabb3a274","subtype":"command","commandType":"auto","position":4.999987691640854,"command":"posts.select(corr($\"favoritecount\", $\"viewcount\")).show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323891617,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"843ff2f0-32ab-497c-91a0-4ffe61023bf1"},{"version":"CommandV1","origId":1396019039180647,"guid":"d5a2d4a7-7cb4-4f9a-8ae6-f4dfc5e4d08c","subtype":"command","commandType":"auto","position":4.9999876990914345,"command":"%md Wow, a very slight negative correlation!\n\nLet's see how many views we need for one favourite for each site!","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781807,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1966975a-d432-4331-9625-cfa64429b651"},{"version":"CommandV1","origId":1396019039180652,"guid":"c3353fa3-3083-4068-aff6-9d698cf721fc","subtype":"command","commandType":"auto","position":4.999988496303558,"command":"%md Aggregating by multiple functions and renaming fields","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781869,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"21ea8dc4-7022-4a36-af1e-640426965738"},{"version":"CommandV1","origId":1396019039180653,"guid":"bfccca37-7c8c-4134-80ba-7dd188168f92","subtype":"command","commandType":"auto","position":4.999988526105881,"command":"import org.apache.spark.sql.functions._\nval aggregatedData = posts.groupBy(\"site\").agg(\n    avg(\"favoriteCount\").as(\"avgFavCount\"),\n    max(\"viewCount\").as(\"maxViewCount\")\n)\nval filtered = aggregatedData.filter($\"avgFavCount\" > 1)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508324105748,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc7af394-cd5e-42cd-80f3-f5bb03cf8ba7"},{"version":"CommandV1","origId":1396019039180654,"guid":"a88daa00-a035-49ab-a9c4-362b7913b3b8","subtype":"command","commandType":"auto","position":4.999988555908203,"command":"%md ### Sorting","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781891,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a1073866-3666-4e14-833d-56cf625e4ad2"},{"version":"CommandV1","origId":1396019039180655,"guid":"39f70129-2505-4229-9e09-637556e4997f","subtype":"command","commandType":"auto","position":4.999990463256836,"command":"val sorted1 = posts.orderBy($\"viewcount\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327378187,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a691dc35-8ffe-468f-b57a-1d639eb0439d"},{"version":"CommandV1","origId":1396019039180656,"guid":"d0ef3261-ac92-465a-b225-dcdb6bca2af4","subtype":"command","commandType":"auto","position":4.999990940093994,"command":"sorted1.select($\"title\", $\"viewcount\").show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327382087,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7a21fa25-ffb0-4044-a25d-1e363a0c8249"},{"version":"CommandV1","origId":1396019039180657,"guid":"aa6493d5-8735-4cb7-ab90-57bfe838bfac","subtype":"command","commandType":"auto","position":4.9999918937683105,"command":"val sorted2 = posts.select($\"title\", $\"viewcount\").orderBy($\"viewcount\".desc)\nsorted2.show(10, false)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327477469,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9fd7be28-f32f-405e-9727-7324f68b1fb4"},{"version":"CommandV1","origId":1396019039180658,"guid":"6d9266f9-a897-4047-b9d3-3cb1646f2086","subtype":"command","commandType":"auto","position":4.9999920129776,"command":"%md #### Limiting the results","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781933,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"784a3b40-e29f-4435-b380-144f8f08e0d8"},{"version":"CommandV1","origId":1396019039180659,"guid":"20c66e6c-1cbc-49cc-a48e-d8942b378a84","subtype":"command","commandType":"auto","position":4.999992072582245,"command":"val sorted2 = posts.orderBy($\"viewcount\".desc)\nsorted2.select($\"title\", $\"viewcount\").limit(3).show(10, false)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781950,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"193e6b81-6e6a-42c9-8697-ff570b145238"},{"version":"CommandV1","origId":1396019039180660,"guid":"74a2b3a8-3277-4224-99af-b1c492052c3a","subtype":"command","commandType":"auto","position":4.99999213218689,"command":"%md ### Renaming fields","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781957,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e9744d3-a6bc-4439-a2fd-7f9afc2536e7"},{"version":"CommandV1","origId":1396019039180661,"guid":"5a2f916e-e6ee-4639-8f51-33e2ede75505","subtype":"command","commandType":"auto","position":4.999992251396179,"command":"posts.select($\"favoriteCount\" > 10).show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781978,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2427b724-391f-4a56-aefd-38010586dbe8"},{"version":"CommandV1","origId":1396019039180662,"guid":"8f667762-69f9-48c1-a75f-5293d14f0fd8","subtype":"command","commandType":"auto","position":4.999992311000824,"command":"posts.select($\"favoriteCount\".alias(\"likes\"),($\"favoriteCount\" > 10).alias(\"liked\")).show()\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781985,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c2d0c984-d09a-4532-a5e9-bf7d34215738"},{"version":"CommandV1","origId":1396019039180663,"guid":"7d7fa235-5a99-405f-9930-419ac5b0e96b","subtype":"command","commandType":"auto","position":4.999992314726114,"command":"%md Also, `as` instead of `alias` works equally well (But not in Python!)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107781992,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18eefb12-44c4-434f-9763-3638c7321906"},{"version":"CommandV1","origId":1396019039180664,"guid":"9f0d583a-380b-4d28-8fe6-c1547fe636c3","subtype":"command","commandType":"auto","position":4.999992318451405,"command":"posts.select($\"favoriteCount\".as(\"likes\"),($\"favoriteCount\" > 10).as(\"liked\")).show()\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782004,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e934a1e0-e9ce-4372-8548-5e6b49e4e148"},{"version":"CommandV1","origId":1396019039180667,"guid":"2e8535c6-45d5-42e3-8b46-d06ceeb1c59e","subtype":"command","commandType":"auto","position":4.999992340803146,"command":"%md ### Adding an extra column","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782312,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c0e84b8-753a-484e-aac2-33392c2c7268"},{"version":"CommandV1","origId":1396019039180668,"guid":"d0e70d42-9341-4b3f-8323-4b6825cded4c","subtype":"command","commandType":"auto","position":4.999992348253727,"command":"posts.select($\"site\",$\"favoriteCount\", ($\"favoriteCount\" > 10).as(\"liked\"))\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508326642238,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd796a90-aea0-4c8d-be8d-28bcb4723a4f"},{"version":"CommandV1","origId":1396019039180669,"guid":"258d8de1-4d6f-4824-bc0f-420529c9e467","subtype":"command","commandType":"auto","position":4.999992355704308,"command":"val postsWithFCLimit = posts.withColumn(\"fcLimit\", $\"favoriteCount\" > 10)\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508326805494,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e39eefa-c9af-4f75-b58a-0196f3562e2d"},{"version":"CommandV1","origId":1396019039180670,"guid":"1c67fa18-e52d-4343-a9ec-d239b79e47da","subtype":"command","commandType":"auto","position":4.999992359429598,"command":"%md ### User Defined Functions","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782347,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"409e6057-65e8-4d6e-8707-2f48bffc05ca"},{"version":"CommandV1","origId":1396019039180671,"guid":"fd73858b-53d2-434a-9da9-d2784d8052e2","subtype":"command","commandType":"auto","position":4.999992363154888,"command":"val chocolateCount = spark.udf.register(\"chocolate_count\", (str:String) => \"chocolate\".r.findAllMatchIn(str).length )","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327672211,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18175a7c-b43c-4bfd-90a8-f7b5280c166c"},{"version":"CommandV1","origId":1396019039180672,"guid":"75a97f27-fde9-4d47-a063-ef9e6ab273a1","subtype":"command","commandType":"auto","position":4.9999923668801785,"command":"posts.select($\"title\", chocolateCount($\"title\").as(\"cnt\")).orderBy($\"cnt\".desc).limit(3).show(3, false)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327675031,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"682a41fb-5ea3-42dd-8a80-af718645186a"},{"version":"CommandV1","origId":1396019039180673,"guid":"6c520fd3-a106-42df-84e1-3919efbfc287","subtype":"command","commandType":"auto","position":4.999992368742824,"command":"%md ## Spark SQL","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782387,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"de2e8a3b-da4a-413d-9339-2c1899548bd8"},{"version":"CommandV1","origId":1396019039180674,"guid":"c7de3042-602a-469b-9668-61edbe0fb714","subtype":"command","commandType":"auto","position":4.999992369208485,"command":"%md Spark does provide an SQL interface which support the *SQL 2003 Standard* ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782406,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d8d92496-2ee5-409e-8e93-25f06d741751"},{"version":"CommandV1","origId":1396019039180675,"guid":"a1177237-d777-4ef7-ab68-eece0812de5e","subtype":"command","commandType":"auto","position":4.999992369674146,"command":"posts.createOrReplaceTempView(\"posts_table\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327821848,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"21f44050-fd3b-448f-ae23-f981d12bdae1"},{"version":"CommandV1","origId":1396019039180676,"guid":"9f243d7c-8bc1-41e1-8d10-c41462d711ba","subtype":"command","commandType":"auto","position":4.9999923701398075,"command":"spark.sql(\"SELECT site, COUNT(*) FROM posts_table GROUP BY site ORDER BY count(*) DESC\").show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508327984796,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a5fe265-5cd5-478b-ac81-3d38dc70bce5"},{"version":"CommandV1","origId":1396019039180677,"guid":"847bd537-dbee-485e-9716-e9e0643814f4","subtype":"command","commandType":"auto","position":4.999992370372638,"command":"val result = spark.sql(\"SELECT site, COUNT(*) FROM posts_table GROUP BY site ORDER BY count(*) DESC\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782452,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"56b3cddf-3810-4628-a3e4-c5d6cb9cabd2"},{"version":"CommandV1","origId":1396019039180678,"guid":"14296705-95f4-4400-b3a4-ae60dee7f4f6","subtype":"command","commandType":"auto","position":4.999992370489053,"command":"result.show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782458,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dbe04a5d-5d42-44e4-8a74-d0a719917232"},{"version":"CommandV1","origId":1396019039180679,"guid":"6ac757ea-a303-44f6-b248-cc4191b0e5e0","subtype":"command","commandType":"auto","position":4.999992370547261,"command":"result.select($\"site\").show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782467,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9faef1c1-88c2-4d82-9c10-679961fa1f56"},{"version":"CommandV1","origId":1396019039180680,"guid":"21b0e64a-4b1a-4206-8549-cb97fc147211","subtype":"command","commandType":"auto","position":4.999992370576365,"command":"spark.sql(\"SELECT title, chocolate_count(title) as cnt FROM posts_table ORDER by cnt DESC LIMIT 3\").show(3, false);","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782476,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0cc06b05-ebbd-4f83-83d6-472932faf0bf"},{"version":"CommandV1","origId":1396019039180681,"guid":"615adb27-cdaa-49ae-98de-04ff7a1e9a54","subtype":"command","commandType":"auto","position":4.999995231613866,"command":"%md ### You can also mix the DataFrame and the SQL world","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782487,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d254fe9-6c5d-4bf6-a1ec-ea7fb4efa593"},{"version":"CommandV1","origId":1396019039180682,"guid":"041d8878-27d0-4ebf-b998-06aa6d5ab116","subtype":"command","commandType":"auto","position":4.999996662132617,"command":"val totalsDF = spark.sql(\"SELECT site, SUM(viewcount) as totalViews FROM posts_table GROUP BY site\").orderBy($\"totalViews\".desc)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782507,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc974645-0be1-43c3-8609-7cd7a57d5393"},{"version":"CommandV1","origId":1396019039180683,"guid":"fd9d875a-7575-48ba-afc8-8c2d381597ad","subtype":"command","commandType":"auto","position":4.999997377391992,"command":"totalsDF.createOrReplaceTempView(\"totals\")\nspark.sql(\"SELECT * FROM totals\").show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1499107782517,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zoltan+201707@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a90efb46-4e28-4c33-9ce2-076d5a59b19b"},{"version":"CommandV1","origId":2383585558997832,"guid":"5546601f-8e76-4b60-97fc-6f97ffe51498","subtype":"command","commandType":"auto","position":0.5,"command":"%md # NOTE\nThis notebook was created to serve as a demonstrational material for the BUTE Big Data course. **License is not granted for distribution.** <br>\nThis following material was created at [Datapao](http:///datapao.com) a market leader training and consultancy company specialized in Apache Spark, Big Data and Amazon Web Services (AWS).<br>\nIf you are interested in a hands-on Spark training to make you a Spark developer, feel free to reach out to us: **hello@datapao.com**\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7350d9e0-4279-459c-a429-9f77ddeca134"},{"version":"CommandV1","origId":2875565925383126,"guid":"a4031755-505d-48a0-a073-1e41af379155","subtype":"command","commandType":"auto","position":4.990234375,"command":"highScores.show()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323079191,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bc761412-c88a-4dac-988d-95f1d78f833a"},{"version":"CommandV1","origId":2875565925383127,"guid":"4b1f887b-d30a-488f-91c7-39eff2efb483","subtype":"command","commandType":"auto","position":4.9892578125,"command":"val highScores = posts.filter($\"score\" > 100)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508323043150,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4d2982d2-ef54-4301-b754-4448645f45ea"},{"version":"CommandV1","origId":2875565925383128,"guid":"9ebd4c00-5f89-4a16-b71f-73fcd31ec7e5","subtype":"command","commandType":"auto","position":4.999992357566953,"command":"postsWithFCLimit.printSchema()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1508326815138,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"gulyasm@datapao.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cd1351c4-63e0-40d3-8d29-5af9f4ee4b2e"}],"dashboards":[],"guid":"7f3f01ef-4d00-472c-9eae-1aace813d47e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}