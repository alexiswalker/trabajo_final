SELECT INGRESOS.CODIGO || '|' || INGRESOS.MOTIVO || '|' || INGRESOS.DESCRIPCION || '|' || INGRESOS.CATEGORIA ||'|' || INGRESOS.UBICACION, AE_SCA.T_LECT, AE_SCA.T_EST, CASE when to_number(AE_SCA.ESTADO_ACTUAL) IN (13,14,15,16,17,18,19,20,28) THEN to_number(AE_SCA.ESTADO_ACTUAL) ELSE TO_NUMBER(INGRESOS.ESTADO) END AS ESTADO_ACTUAL, INGRESOS.ID_SOCIO FROM ae_v_ingresos INGRESOS LEFT JOIN AE_SCA ON (INGRESOS.ID_SOCIO = AE_SCA.ID_SOCIO) WHERE INGRESOS.NROCHIP = SUBSTR(UPPER('%s'),1,8);