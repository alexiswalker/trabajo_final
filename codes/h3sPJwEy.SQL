-- MySQL Script generated by MySQL Workbench
-- Thu Dec 14 15:52:14 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema reptrace
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema reptrace
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `reptrace` DEFAULT CHARACTER SET utf8 ;
USE `reptrace` ;

-- -----------------------------------------------------
-- Table `reptrace`.`ORGANISATION`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`ORGANISATION` (
  `organisation_id` INT NOT NULL,
  `coc_number` INT NULL,
  `name` VARCHAR(30) NULL,
  `address` VARCHAR(45) NULL,
  `house_number` VARCHAR(6) NULL,
  `postal_code` CHAR(6) NULL,
  `city` VARCHAR(30) NULL,
  `license_activation_date` DATE NULL,
  PRIMARY KEY (`organisation_id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`PERSON`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`PERSON` (
  `person_id` INT NOT NULL,
  `first_name` VARCHAR(20) NULL,
  `last_name` VARCHAR(45) NULL,
  `address` VARCHAR(45) NULL,
  `house_number` VARCHAR(6) NULL,
  `postal_code` CHAR(6) NULL,
  `city` VARCHAR(30) NULL,
  `email_address` VARCHAR(45) NULL,
  PRIMARY KEY (`person_id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`EMPLOYEE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`EMPLOYEE` (
  `employee_id` INT NOT NULL,
  `organisation_id` INT NOT NULL,
  `person_id` INT NOT NULL,
  `username` VARCHAR(60) NOT NULL,
  `password` CHAR(60) BINARY NOT NULL,
  PRIMARY KEY (`employee_id`),
  CONSTRAINT `organisation_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`ORGANISATION` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE,
  CONSTRAINT `person_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`PERSON` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`CUSTOMER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`CUSTOMER` (
  `customer_id` INT NOT NULL,
  `person_id` INT NOT NULL,
  PRIMARY KEY (`customer_id`),
  CONSTRAINT `person_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`PERSON` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`PHONENUMBER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`PHONENUMBER` (
  `phone_number_id` INT NOT NULL,
  `person_id` INT NOT NULL,
  `phone_number` INT NULL,
  `type` VARCHAR(10) NULL,
  PRIMARY KEY (`phone_number_id`),
  CONSTRAINT `person_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`PERSON` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`VEHICLE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`VEHICLE` (
  `frame_number` INT NOT NULL,
  `number_plate` VARCHAR(6) NOT NULL,
  `brand` VARCHAR(15) NULL,
  `type` VARCHAR(15) NULL,
  `type_of_fuel` VARCHAR(7) NULL,
  `color` VARCHAR(10) NULL,
  PRIMARY KEY (`frame_number`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`WORKORDER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`WORKORDER` (
  `reptrace_id` INT NOT NULL,
  `employee_id` INT NOT NULL,
  `customer_id` INT NOT NULL,
  `frame_number` INT NOT NULL,
  `date` DATE NULL,
  `type_of_work` VARCHAR(50) NULL,
  PRIMARY KEY (`reptrace_id`),
  CONSTRAINT `employee_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`EMPLOYEE` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE,
  CONSTRAINT `customer_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`CUSTOMER` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE,
  CONSTRAINT `frame_number`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`VEHICLE` ()
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`PART`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`PART` (
  `part_id` INT NULL,
  `part_name` VARCHAR(30) NULL,
  `part_type` VARCHAR(30) NULL,
  PRIMARY KEY (`part_id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `reptrace`.`WORKORDER_PART_INTERSECTION`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `reptrace`.`WORKORDER_PART_INTERSECTION` (
  `part_id` INT NULL,
  `reptrace_id` VARCHAR(45) NOT NULL,
  `quantity` INT NULL,
  PRIMARY KEY (`reptrace_id`),
  CONSTRAINT `reptrace_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`WORKORDER` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE,
  CONSTRAINT `part_id`
    FOREIGN KEY ()
    REFERENCES `reptrace`.`PART` ()
    ON DELETE SET NULL
    ON UPDATE CASCADE)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;