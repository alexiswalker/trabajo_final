SELECT distinct TENANCIES.TCY_REFNO, TENANCIES.TCY_NOTICE_REC_DATE, TENANCIES.TCY_NOTICE_GIVEN_DATE, TENANCIES.TCY_HRV_TTYP_CODE, TENANCIES.TCY_HRV_TTR_CODE, TENANCIES.TCY_HRV_TSO_CODE, TENANCIES.TCY_HRV_TNR_CODE, TENANCIES.TCY_EXPECTED_END_DATE, TENANCIES.TCY_ENDED_DATE, TENANCIES.TCY_ENDED_BY, TENANCIES.TCY_CREATED_DATE, TENANCIES.TCY_CREATED_BY, TENANCIES.TCY_CORRESPOND_NAME, TENANCIES.TCY_ACT_START_DATE,TENANCY_HOLDINGS.THO_PRO_REFNO, HOUSEHOLD_PERSONS.HOP_PAR_REFNO
FROM TENANCIES
inner join TENANCY_HOLDINGS on TENANCIES.TCY_REFNO=TENANCY_HOLDINGS.THO_TCY_REFNO
inner join TENANCY_INSTANCES on TENANCIES.TCY_REFNO=TENANCY_INSTANCES.TIN_TCY_REFNO
inner join HOUSEHOLD_PERSONS on TENANCY_INSTANCES.TIN_HOP_REFNO=HOUSEHOLD_PERSONS.HOP_REFNO
left join TENANCY_CHANGES TC1 on TCY_REFNO=TCYC_TCY_REFNO 
where 
TENANCY_INSTANCES.TIN_MAIN_TENANT_IND='Y'
--and TCY_ACT_START_DATE<=sysdate
--and (TCY_ENDED_DATE is null or (TCY_ENDED_DATE>'$$PREV_SESS_START_DATE' AND TCY_ENDED_DATE<='$$$SessStartTime'))
AND(
(TENANCY_HOLDINGS.THO_CREATED_DATE>'$$PREV_SESS_START_DATE' AND TENANCY_HOLDINGS.THO_CREATED_DATE<='$$$SessStartTime')
OR
(TENANCY_INSTANCES.TIN_CREATED_DATE > '$$PREV_SESS_START_DATE' AND TENANCY_INSTANCES.TIN_CREATED_DATE <='$$$SessStartTime')
OR
(TENANCIES.TCY_CREATED_DATE>'$$PREV_SESS_START_DATE' AND TENANCIES.TCY_CREATED_DATE<='$$$SessStartTime')
OR
(TCY_ENDED_DATE>'$$PREV_SESS_START_DATE' AND TCY_ENDED_DATE<='$$$SessStartTime')
OR
(TCYC_MODIFIED_DATE >'$$PREV_SESS_START_DATE' AND TCYC_MODIFIED_DATE<='$$$SessStartTime')
OR
(THO_START_DATE >'$$PREV_SESS_START_DATE' AND THO_START_DATE<='$$$SessStartTime')
OR
(TIN_START_DATE >'$$PREV_SESS_START_DATE' AND TIN_START_DATE<='$$$SessStartTime')
)
--AND (THO_START_DATE<= SYSDATE AND (THO_END_DATE IS NULL OR THO_END_DATE>SYSDATE))
--AND (HOP_START_DATE<= SYSDATE AND (HOP_END_DATE IS NULL OR  HOP_END_DATE>SYSDATE))
--AND (TIN_START_DATE<= SYSDATE AND (TIN_END_DATE IS NULL OR TIN_END_DATE>SYSDATE))